#include <DHT.h>

// ðŸŸ© Pin Configuration
#define DHTPIN 5              // DHT22 DATA pin
#define DHTTYPE DHT22
#define PIRPIN 4              // PIR sensor pin
#define MQ135_PIN 34          // MQ135 analog output to GPIO34

// ðŸŸ© DHT Sensor
DHT dht(DHTPIN, DHTTYPE);

void setup() {
  Serial.begin(115200);
  
  dht.begin();
  pinMode(PIRPIN, INPUT);
  pinMode(MQ135_PIN, INPUT);

  Serial.println("âœ… ESP32 Initialized with:");
  Serial.println("ðŸ“ DHT22 on GPIO5");
  Serial.println("ðŸ“ PIR on GPIO4");
  Serial.println("ðŸ“ MQ135 on GPIO34 (Analog)");
}

void loop() {
  // ðŸŸ¦ 1. PIR Motion Detection
  bool motionDetected = digitalRead(PIRPIN);
  Serial.println(motionDetected ? "ðŸ”” Motion Detected!" : "â³ No Motion.");

  // ðŸŸ¦ 2. DHT22 Sensor (Temperature & Humidity)
  delay(2000);  // DHT22 needs at least 2 seconds delay between reads
  float humidity = dht.readHumidity();
  float temperature = dht.readTemperature();

  if (isnan(humidity) || isnan(temperature)) {
    Serial.println("âš  Failed to read from DHT22 sensor!");
  } else {
    Serial.print("ðŸŒ¡ Temp: ");
    Serial.print(temperature);
    Serial.print(" Â°C  |  ðŸ’§ Humidity: ");
    Serial.print(humidity);
    Serial.println(" %");
  }

  // ðŸŸ¦ 3. MQ135 Air Quality Reading
  int mq135Value = analogRead(MQ135_PIN);  // 0â€“4095 on ESP32
  Serial.print("ðŸŸ« MQ135 Analog Value: ");
  Serial.println(mq135Value);

  // Optional: interpret air quality roughly
  if (mq135Value > 2000) {
    Serial.println("ðŸ˜· Air Quality: Poor (Gas Detected)");
  } else {
    Serial.println("ðŸ˜Š Air Quality: Good");
  }

  Serial.println("--------------------------------------------------");
  delay(2000); // Delay before next loop
}
